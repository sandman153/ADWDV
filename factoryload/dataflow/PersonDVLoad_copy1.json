{
	"name": "PersonDVLoad_copy1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "GeneralSink",
						"type": "DatasetReference"
					},
					"name": "DVSource"
				},
				{
					"dataset": {
						"referenceName": "HUBPerson",
						"type": "DatasetReference"
					},
					"name": "HUBPerson"
				},
				{
					"dataset": {
						"referenceName": "PersonSAT",
						"type": "DatasetReference"
					},
					"name": "SATPerson"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "PersonSAT",
						"type": "DatasetReference"
					},
					"name": "SinkSatPerson"
				},
				{
					"dataset": {
						"referenceName": "HUBPerson",
						"type": "DatasetReference"
					},
					"name": "SinkHubPerson"
				}
			],
			"transformations": [
				{
					"name": "hashColumns"
				},
				{
					"name": "CheckNewSatPerson"
				},
				{
					"name": "NewHubRecords"
				},
				{
					"name": "NewSatPerson"
				},
				{
					"name": "CheckNewPerson"
				},
				{
					"name": "NewHubPerson"
				}
			],
			"script": "parameters{\n\tbkey as string,\n\thubname as string,\n\tsatname as string\n}\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> DVSource\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> HUBPerson\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> SATPerson\nDVSource derive(PersonVID = sha1(toString(byName($bkey)) ),\n\t\tLoad_TS = currentTimestamp()) ~> hashColumns\nhashColumns, SATPerson exists(hashColumns@PersonVID == SATPerson@PersonVID,\n\tnegate:true,\n\tbroadcast: 'none')~> CheckNewSatPerson\nCheckNewSatPerson alterRow(insertIf(true())) ~> NewHubRecords\nNewHubRecords select(skipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> NewSatPerson\nhashColumns, HUBPerson exists(hashColumns@PersonVID == HUBPerson@PersonVID,\n\tnegate:true,\n\tbroadcast: 'none')~> CheckNewPerson\nCheckNewPerson select(mapColumn(\n\t\tBusinessEntityID,\n\t\tPersonVID,\n\t\tLoadDateTime = Load_TS\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> NewHubPerson\nNewSatPerson sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SinkSatPerson\nNewHubPerson sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SinkHubPerson"
		}
	}
}